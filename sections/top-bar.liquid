{%- comment -%}Top Bar Section{%- endcomment -%}
{% assign cs = section.settings.color_scheme | color_scheme %}
<style>
  .tf-topbar {
    --color-background: {{ cs.background }};
    --color-text: {{ cs.text }};
    --color-primary-button: {{ cs.primary_button }};
    --color-primary-button-text: {{ cs.on_primary_button }};
    --color-primary-button-border: {{ cs.primary_button_border }};
    --color-secondary-button: {{ cs.secondary_button }};
    --color-secondary-button-text: {{ cs.on_secondary_button }};
    --color-secondary-button-border: {{ cs.secondary_button_border }};
    --color-links: {{ cs.links }};
    --color-icons: {{ cs.icons }};
  }
  .tf-topbar {
    background: var(--color-background);
    color: var(--color-text);
  }
  .tf-topbar a {
    color: var(--color-text);
  }
  .tf-topbar a:hover {
    color: var(--color-links);
  }
  .tf-topbar .icon {
    color: var(--color-icons);
  }
</style>
<div class="tf-topbar topbar-bg" style="padding-top: {{ section.settings.padding_top }}px; padding-bottom: {{ section.settings.padding_bottom }}px;">
  <div class="container">
    <div class="topbar-wraper">
      {%- for block in section.blocks -%}
        {%- case block.type -%}
          {%- when 'social_media' -%}
            <div class="d-none d-xl-block flex-shrink-0" {{ block.shopify_attributes }}>
              <ul class="tf-social-icon topbar-left">
                {%- if block.settings.facebook_url != blank -%}
                  <li>
                    <a href="{{ block.settings.facebook_url }}" class="social-item social-facebook" target="_blank" rel="noopener">
                      <i class="icon icon-fb"></i>
                    </a>
                  </li>
                {%- endif -%}
                {%- if block.settings.instagram_url != blank -%}
                  <li>
                    <a href="{{ block.settings.instagram_url }}" class="social-item social-instagram" target="_blank" rel="noopener">
                      <i class="icon icon-instagram"></i>
                    </a>
                  </li>
                {%- endif -%}
                {%- if block.settings.twitter_url != blank -%}
                  <li>
                    <a href="{{ block.settings.twitter_url }}" class="social-item social-x" target="_blank" rel="noopener">
                      <i class="icon icon-x"></i>
                    </a>
                  </li>
                {%- endif -%}
                {%- if block.settings.snapchat_url != blank -%}
                  <li>
                    <a href="{{ block.settings.snapchat_url }}" class="social-item social-snapchat" target="_blank" rel="noopener">
                      <i class="icon icon-snapchat"></i>
                    </a>
                  </li>
                {%- endif -%}
              </ul>
            </div>
          {%- when 'announcement' -%}
            <div class="overflow-hidden" {{ block.shopify_attributes }}>
              <div class="topbar-center marquee-wrapper" data-speed="{{ section.settings.announcement_speed }}">
                <div class="initial-child-container">
                  {%- for i in (1..3) -%}
                    {%- assign announcements = block.settings.announcements | split: '\n' -%}
                    {%- for announcement in announcements -%}
                      <div class="marquee-child-item">
                        <p>{{ announcement }}</p>
                      </div>
                        <div class="marquee-child-item"><span class="dot"></span></div>
                    {%- endfor -%}
                  {%- endfor -%}
                </div>
              </div>
            </div>
          {%- when 'language_currency' -%}
            <div class="d-none d-xl-block flex-shrink-0" {{ block.shopify_attributes }}>
              <div class="topbar-right">
                {%- if block.settings.show_language -%}
                  <div class="tf-languages">
                    <select class="image-select center style-default type-languages" name="language">
                      {% for locale in shop.published_locales %}
                        <option value="{{ locale.iso_code }}" {% if locale.primary %}selected{% endif %}>
                          {{ locale.name }}
                        </option>
                      {% endfor %}
                    </select>
                  </div>
                {%- endif -%}
                {%- if block.settings.show_currency -%}
                  <div class="tf-currencies">
                    <select class="image-select center style-default type-currencies" name="currency">
                      {% for currency in shop.enabled_currencies %}
                        {% assign country_name = "" %}
                        {% assign thumbnail_path = "" %}
                        {% case currency.iso_code %}
                          {% when 'USD' %}
                            {% assign country_name = "United States" %}
                            {% assign thumbnail_path = "us.png" | asset_url %}
                          {% when 'EUR' %}
                            {% assign country_name = "France" %}
                          {% when 'VND' %}
                            {% assign country_name = "Vietnam" %}
                          {% else %}
                            {% assign country_name = currency.name %}
                        {% endcase %}
                        <option value="{{ currency.iso_code }}" {% if currency == cart.currency %}selected{% endif %} {% if thumbnail_path != blank %}data-thumbnail="{{ thumbnail_path }}"{% endif %}>
                          {{ country_name }} ({{ currency.iso_code }} {{ currency.symbol }})
                        </option>
                      {% endfor %}
                    </select>
                  </div>
                {%- endif -%}
              </div>
            </div>
        {%- endcase -%}
      {%- endfor -%}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Top bar",
  "max_blocks": 3,
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "default"
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 50,
      "step": 2,
      "unit": "px",
      "label": "Top padding",
      "default": 10
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 50,
      "step": 2,
      "unit": "px",
      "label": "Bottom padding",
      "default": 10
    },
    {
      "type": "header",
      "content": "Animation"
    },
    {
      "type": "select",
      "id": "announcement_speed",
      "label": "Announcement speed",
      "options": [
        {
          "value": "slow",
          "label": "Slow"
        },
        {
          "value": "normal",
          "label": "Normal"
        },
        {
          "value": "fast",
          "label": "Fast"
        }
      ],
      "default": "normal"
    }
  ],
  "blocks": [
    {
      "type": "social_media",
      "name": "Social Media",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "facebook_url",
          "label": "Facebook URL",
          "info": "https://www.facebook.com/your-page",
          "default": "https://www.facebook.com/"
        },
        {
          "type": "text",
          "id": "instagram_url",
          "label": "Instagram URL",
          "info": "https://www.instagram.com/your-profile",
          "default": "https://www.instagram.com/"
        },
        {
          "type": "text",
          "id": "twitter_url",
          "label": "Twitter URL",
          "info": "https://twitter.com/your-profile",
          "default": "https://x.com/"
        },
        {
          "type": "text",
          "id": "snapchat_url",
          "label": "Snapchat URL",
          "info": "https://www.snapchat.com/add/your-profile",
          "default": "https://www.snapchat.com/"
        }
      ]
    },
    {
      "type": "announcement",
      "name": "Announcement Bar",
      "limit": 1,
      "settings": [
        {
          "type": "header",
          "content": "Announcements"
        },
        {
          "type": "textarea",
          "id": "announcements",
          "label": "Announcements",
          "info": "Enter each announcement on a new line",
          "default": "Return extended to 60 days\nLife-time Guarantees\nLimited-Time Offer"
        }
      ]
    },
    {
      "type": "language_currency",
      "name": "Language & Currency",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_language",
          "label": "Show language selector",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_currency",
          "label": "Show currency selector",
          "default": true
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Top bar",
      "settings": {
        // No color settings needed, uses global color scheme
      },
      "blocks": [
        {
          "type": "social_media",
          "settings": {
            "facebook_url": "https://www.facebook.com/",
            "instagram_url": "https://www.instagram.com/",
            "twitter_url": "https://x.com/",
            "snapchat_url": "https://www.snapchat.com/"
          }
        },
        {
          "type": "announcement",
          "settings": {
            "announcements": "Return extended to 60 days\nLife-time Guarantees\nLimited-Time Offer"
          }
        },
        {
          "type": "language_currency"
        }
      ]
    }
  ]
}
{% endschema %}