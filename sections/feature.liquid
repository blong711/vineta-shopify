{%- comment -%}
  Feature Products Section
  Usage: {% section 'feature' %}
{%- endcomment -%}

<section class="flat-spacing-3">
    <div class="container" style="max-width: {{ section.settings.width }}px;">
        <div class="flat-title-v2 justify-items-center text-center wow fadeInUp">
            <a href="{{ section.settings.button_url }}" class="tf-btn btn-out-line-green btn-small text-uppercase">{{ section.settings.button_text }}</a>
            <h4 class="text-capitalize">{{ section.settings.heading | replace: '[br]', '<br class="d-none d-xl-block">' }}</h4>
        </div>
        <div class="fl-control-sw wow fadeInUp">
            <div dir="ltr" class="swiper tf-swiper feature-swiper" data-swiper='{
                "slidesPerView": {{ section.settings.slides_per_view_mobile }},
                "spaceBetween": {{ section.settings.space_between_mobile }},
                "speed": {{ section.settings.transition_speed }},
                "observer": true,
                "observeParents": true,
                "slidesPerGroup": {{ section.settings.slides_per_group_mobile }},
                "loop": {{ section.settings.loop }},
                "navigation": {% if section.settings.show_navigation %}{
                    "clickable": true,
                    "nextEl": ".nav-next-feature",
                    "prevEl": ".nav-prev-feature"
                }{% else %}false{% endif %},
                "pagination": {% if section.settings.show_pagination %}{
                    "el": ".sw-pagination-feature",
                    "clickable": true
                }{% else %}false{% endif %},
                "autoplay": {% if section.settings.autoplay %}{
                    "delay": {{ section.settings.autoplay_speed }}
                }{% else %}false{% endif %},
                "breakpoints": {
                    "768": {
                        "slidesPerView": {{ section.settings.slides_per_view_tablet }},
                        "spaceBetween": {{ section.settings.space_between_mobile }},
                        "slidesPerGroup": {{ section.settings.slides_per_group_tablet }}
                    },
                    "1200": {
                        "slidesPerView": {{ section.settings.slides_per_view_desktop }},
                        "spaceBetween": {{ section.settings.space_between_desktop }},
                        "slidesPerGroup": {{ section.settings.slides_per_group_desktop }}
                    }
                }
            }'>
                <div class="swiper-wrapper">
                    {%- if section.settings.product_source == 'collection' and section.settings.collection != blank -%}
                        {%- for product in section.settings.collection.products limit: 12 -%}
                            <div class="swiper-slide">
                                {% render 'card-product',
                                    product: product,
                                    show_sale_badge: true,
                                    show_color_swatches: true,
                                    selected_variant: product.selected_or_first_available_variant,
                                    class: 'style-border',
                                    product-info: 'text-center'
                                %}
                            </div>
                        {%- endfor -%}
                    {%- elsif section.settings.product_source == 'product_list' and section.settings.product_list != blank -%}
                        {%- for product in section.settings.product_list -%}
                            <div class="swiper-slide">
                                {% render 'card-product',
                                    product: product,
                                    show_sale_badge: true,
                                    show_color_swatches: true,
                                    selected_variant: product.selected_or_first_available_variant,
                                    class: 'style-border',
                                    product-info: 'text-center'
                                %}
                            </div>
                        {%- endfor -%}
                    {%- endif -%}
                </div>
                <div class="d-flex d-xl-none sw-dot-default sw-pagination-feature justify-content-center"></div>
            </div>
            <div class="d-none d-xl-flex swiper-button-next nav-swiper nav-next-feature"></div>
            <div class="d-none d-xl-flex swiper-button-prev nav-swiper nav-prev-feature"></div>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    new Swiper('.feature-swiper', {
        slidesPerView: {{ section.settings.slides_per_view_mobile }},
        spaceBetween: {{ section.settings.space_between_mobile }},
        speed: {{ section.settings.transition_speed }},
        observer: true,
        observeParents: true,
        slidesPerGroup: {{ section.settings.slides_per_group_mobile }},
        loop: {{ section.settings.loop }},
        navigation: {% if section.settings.show_navigation %}{
            nextEl: '.nav-next-feature',
            prevEl: '.nav-prev-feature'
        }{% else %}false{% endif %},
        pagination: {% if section.settings.show_pagination %}{
            el: '.sw-pagination-feature',
            clickable: true
        }{% else %}false{% endif %},
        autoplay: {% if section.settings.autoplay %}{
            delay: {{ section.settings.autoplay_speed }}
        }{% else %}false{% endif %},
        breakpoints: {
            768: {
                slidesPerView: {{ section.settings.slides_per_view_tablet }},
                spaceBetween: {{ section.settings.space_between_mobile }},
                slidesPerGroup: {{ section.settings.slides_per_group_tablet }}
            },
            1200: {
                slidesPerView: {{ section.settings.slides_per_view_desktop }},
                spaceBetween: {{ section.settings.space_between_desktop }},
                slidesPerGroup: {{ section.settings.slides_per_group_desktop }}
            }
        }
    });
});
</script>

{% schema %}
{
    "name": "Featured Products",
    "settings": [
        {
            "type": "range",
            "id": "width",
            "min": 1000,
            "max": 1600,
            "step": 8,
            "unit": "px",
            "label": "Section width",
            "default": 1488
        },
        {
            "type": "text",
            "id": "button_text",
            "label": "Button Text",
            "default": "Featured Products"
        },
        {
            "type": "url",
            "id": "button_url",
            "label": "Button URL"
        },
        {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "Discover our top picks for [br] every ride"
        },
        {
            "type": "select",
            "id": "product_source",
            "label": "Product Source",
            "options": [
                {
                    "value": "collection",
                    "label": "Collection"
                },
                {
                    "value": "product_list",
                    "label": "Product List"
                }
            ],
            "default": "collection"
        },
        {
            "type": "collection",
            "id": "collection",
            "label": "Collection",
            "info": "Select a collection to display its products"
        },
        {
            "type": "product_list",
            "id": "product_list",
            "label": "Product List",
            "info": "Select products to display",
            "limit": 12
        },
        {
            "type": "header",
            "content": "Slider Settings"
        },
        {
            "type": "range",
            "id": "slides_per_view_mobile",
            "min": 1,
            "max": 3,
            "step": 1,
            "label": "Slides per view (Mobile)",
            "default": 2
        },
        {
            "type": "range",
            "id": "slides_per_view_tablet",
            "min": 1,
            "max": 3,
            "step": 1,
            "label": "Slides per view (Tablet)",
            "default": 3
        },
        {
            "type": "range",
            "id": "slides_per_view_desktop",
            "min": 3,
            "max": 6,
            "step": 1,
            "label": "Slides per view (Desktop)",
            "default": 4
        },
        {
            "type": "range",
            "id": "slides_per_group_mobile",
            "min": 1,
            "max": 3,
            "step": 1,
            "label": "Slides per group (Mobile)",
            "default": 2
        },
        {
            "type": "range",
            "id": "slides_per_group_tablet",
            "min": 1,
            "max": 3,
            "step": 1,
            "label": "Slides per group (Tablet)",
            "default": 3
        },
        {
            "type": "range",
            "id": "slides_per_group_desktop",
            "min": 1,
            "max": 4,
            "step": 1,
            "label": "Slides per group (Desktop)",
            "default": 4
        },
        {
            "type": "range",
            "id": "space_between_mobile",
            "min": 0,
            "max": 30,
            "step": 2,
            "label": "Space between slides (Mobile)",
            "default": 12
        },
        {
            "type": "range",
            "id": "space_between_desktop",
            "min": 0,
            "max": 50,
            "step": 2,
            "label": "Space between slides (Desktop)",
            "default": 24
        },
        {
            "type": "range",
            "id": "transition_speed",
            "min": 300,
            "max": 2000,
            "step": 100,
            "label": "Transition speed (ms)",
            "default": 1000
        },
        {
            "type": "checkbox",
            "id": "show_navigation",
            "label": "Show navigation buttons",
            "default": true
        },
        {
            "type": "checkbox",
            "id": "show_pagination",
            "label": "Show pagination dots",
            "default": true
        },
        {
            "type": "checkbox",
            "id": "autoplay",
            "label": "Enable autoplay",
            "default": false
        },
        {
            "type": "range",
            "id": "autoplay_speed",
            "min": 1000,
            "max": 9000,
            "step": 500,
            "label": "Autoplay speed (ms)",
            "default": 3000
        },
        {
            "type": "checkbox",
            "id": "loop",
            "label": "Enable infinite loop",
            "default": true
        }
    ],
    "presets": [
        {
            "name": "Featured Products",
            "category": "Product slider",
            "settings": {
                "button_text": "Featured Products",
                "heading": "Discover our top picks for [br] every ride",
                "product_source": "collection",
                "collection": "all",
                "slides_per_view_desktop": 4,
                "slides_per_view_tablet": 3,
                "slides_per_view_mobile": 2,
                "slides_per_group_desktop": 4,
                "slides_per_group_tablet": 3,
                "slides_per_group_mobile": 2,
                "space_between_desktop": 24,
                "space_between_mobile": 12,
                "transition_speed": 1000,
                "show_navigation": true,
                "show_pagination": true,
                "autoplay": false,
                "autoplay_speed": 3000,
                "loop": true
            }
        }
    ]
}
{% endschema %} 